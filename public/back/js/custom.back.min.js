/*!

=========================================================
* Argon Dashboard - v1.0.0
=========================================================

* Product Page: https://www.creative-tim.com/product/argon-dashboard
* Copyright 2018 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard/blob/master/LICENSE.md)

* Coded by www.creative-tim.com

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

*/
"use strict";var map,lat,lng,Datepicker=function(){var a=$(".datepicker");a.length&&a.each(function(){$(this).datepicker({disableTouchKeyboard:!0,autoclose:!1})})}(),CopyIcon=function(){var a,e=".btn-icon-clipboard",t=$(e);t.length&&((a=t).tooltip().on("mouseleave",function(){a.tooltip("hide")}),new ClipboardJS(e).on("success",function(a){$(a.trigger).attr("title","Copied!").tooltip("_fixTitle").tooltip("show").attr("title","Copy to clipboard").tooltip("_fixTitle"),a.clearSelection()}))}(),FormControl=function(){var a=$(".form-control");a.length&&a.on("focus blur",function(a){$(this).parents(".form-group").toggleClass("focused","focus"===a.type||0<this.value.length)}).trigger("blur")}(),$map=$("#map-canvas"),color="#5e72e4";function initMap(){map=document.getElementById("map-canvas"),lat=map.getAttribute("data-lat"),lng=map.getAttribute("data-lng");var a=new google.maps.LatLng(lat,lng),e={zoom:12,scrollwheel:!1,center:a,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:color},{visibility:"on"}]}]};map=new google.maps.Map(map,e);var t=new google.maps.Marker({position:a,map:map,animation:google.maps.Animation.DROP,title:"Hello World!"}),o=new google.maps.InfoWindow({content:'<div class="info-window-content"><h2>Argon Dashboard</h2><p>A beautiful Dashboard for Bootstrap 4. It is Free and Open Source.</p></div>'});google.maps.event.addListener(t,"click",function(){o.open(map,t)})}$map.length&&google.maps.event.addDomListener(window,"load",initMap);var Navbar=function(){var e=$(".navbar-nav, .navbar-nav .nav"),t=$(".navbar .collapse"),a=$(".navbar .dropdown");t.on({"show.bs.collapse":function(){var a;(a=$(this)).closest(e).find(t).not(a).collapse("hide")}}),a.on({"hide.bs.dropdown":function(){var a,e;a=$(this),(e=a.find(".dropdown-menu")).addClass("close"),setTimeout(function(){e.removeClass("close")},200)}})}(),NavbarCollapse=function(){$(".navbar-nav");var a=$(".navbar .collapse");a.length&&(a.on({"hide.bs.collapse":function(){a.addClass("collapsing-out")}}),a.on({"hidden.bs.collapse":function(){a.removeClass("collapsing-out")}}))}(),noUiSlider=function(){if($(".input-slider-container")[0]&&$(".input-slider-container").each(function(){var a=$(this).find(".input-slider"),e=a.attr("id"),t=a.data("range-value-min"),o=a.data("range-value-max"),n=$(this).find(".range-slider-value"),r=n.attr("id"),l=n.data("range-value-low"),i=document.getElementById(e),s=document.getElementById(r);noUiSlider.create(i,{start:[parseInt(l)],connect:[!0,!1],range:{min:[parseInt(t)],max:[parseInt(o)]}}),i.noUiSlider.on("update",function(a,e){s.textContent=a[e]})}),$("#input-slider-range")[0]){var a=document.getElementById("input-slider-range"),e=document.getElementById("input-slider-range-value-low"),t=document.getElementById("input-slider-range-value-high"),o=[e,t];noUiSlider.create(a,{start:[parseInt(e.getAttribute("data-range-value-low")),parseInt(t.getAttribute("data-range-value-high"))],connect:!0,range:{min:parseInt(a.getAttribute("data-range-value-min")),max:parseInt(a.getAttribute("data-range-value-max"))}}),a.noUiSlider.on("update",function(a,e){o[e].textContent=a[e]})}}(),Popover=function(){var a=$('[data-toggle="popover"]'),t="";a.length&&a.each(function(){!function(a){a.data("color")&&(t="popover-"+a.data("color"));var e={trigger:"focus",template:'<div class="popover '+t+'" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'};a.popover(e)}($(this))})}(),ScrollTo=function(){var a=$(".scroll-me, [data-scroll-to], .toc-entry a");a.length&&a.on("click",function(a){var e,t,o,n;e=$(this),t=e.attr("href"),o=e.data("scroll-to-offset")?e.data("scroll-to-offset"):0,n={scrollTop:$(t).offset().top-o},$("html, body").stop(!0,!0).animate(n,600),event.preventDefault()})}(),Tooltip=function(){var a=$('[data-toggle="tooltip"]');a.length&&a.tooltip()}(),Charts=function(){var a,e=$('[data-toggle="chart"]'),t="light",o={base:"Open Sans"},n={gray:{100:"#f6f9fc",200:"#e9ecef",300:"#dee2e6",400:"#ced4da",500:"#adb5bd",600:"#8898aa",700:"#525f7f",800:"#32325d",900:"#212529"},theme:{default:"#172b4d",primary:"#5e72e4",secondary:"#f4f5f7",info:"#11cdef",success:"#2dce89",danger:"#f5365c",warning:"#fb6340"},black:"#12263F",white:"#FFFFFF",transparent:"transparent"};function r(a,e){for(var t in e)"object"!=typeof e[t]?a[t]=e[t]:r(a[t],e[t])}function l(a){var e=a.data("add"),t=$(a.data("target")).data("chart");a.is(":checked")?function a(e,t){for(var o in t)Array.isArray(t[o])?t[o].forEach(function(a){e[o].push(a)}):a(e[o],t[o])}(t,e):function a(e,t){for(var o in t)Array.isArray(t[o])?t[o].forEach(function(a){e[o].pop()}):a(e[o],t[o])}(t,e),t.update()}function i(a){var e=a.data("update"),t=$(a.data("target")).data("chart");r(t,e),function(a,e){if(void 0!==a.data("prefix")||void 0!==a.data("prefix")){var r=a.data("prefix")?a.data("prefix"):"",l=a.data("suffix")?a.data("suffix"):"";e.options.scales.yAxes[0].ticks.callback=function(a){if(!(a%10))return r+a+l},e.options.tooltips.callbacks.label=function(a,e){var t=e.datasets[a.datasetIndex].label||"",o=a.yLabel,n="";return 1<e.datasets.length&&(n+='<span class="popover-body-label mr-auto">'+t+"</span>"),n+='<span class="popover-body-value">'+r+o+l+"</span>"}}}(a,t),t.update()}return window.Chart&&r(Chart,(a={defaults:{global:{responsive:!0,maintainAspectRatio:!1,defaultColor:n.gray[600],defaultFontColor:n.gray[600],defaultFontFamily:o.base,defaultFontSize:13,layout:{padding:0},legend:{display:!1,position:"bottom",labels:{usePointStyle:!0,padding:16}},elements:{point:{radius:0,backgroundColor:n.theme.primary},line:{tension:.4,borderWidth:4,borderColor:n.theme.primary,backgroundColor:n.transparent,borderCapStyle:"rounded"},rectangle:{backgroundColor:n.theme.warning},arc:{backgroundColor:n.theme.primary,borderColor:n.white,borderWidth:4}},tooltips:{enabled:!1,mode:"index",intersect:!1,custom:function(o){var a=$("#chart-tooltip");if(a.length||(a=$('<div id="chart-tooltip" class="popover bs-popover-top" role="tooltip"></div>'),$("body").append(a)),0!==o.opacity){if(o.body){var e=o.title||[],n=o.body.map(function(a){return a.lines}),r="";r+='<div class="arrow"></div>',e.forEach(function(a){r+='<h3 class="popover-header text-center">'+a+"</h3>"}),n.forEach(function(a,e){o.labelColors[e].backgroundColor;var t=1<n.length?"justify-content-left":"justify-content-center";r+='<div class="popover-body d-flex align-items-center '+t+'"><span class="badge badge-dot"><i class="bg-primary"></i></span>'+a+"</div>"}),a.html(r)}var t=$(this._chart.canvas),l=(t.outerWidth(),t.outerHeight(),t.offset().top),i=t.offset().left,s=a.outerWidth(),d=a.outerHeight(),c=l+o.caretY-d-16,p=i+o.caretX-s/2;a.css({top:c+"px",left:p+"px",display:"block","z-index":"100"})}else a.css("display","none")},callbacks:{label:function(a,e){var t=e.datasets[a.datasetIndex].label||"",o=a.yLabel,n="";return 1<e.datasets.length&&(n+='<span class="badge badge-primary mr-auto">'+t+"</span>"),n+='<span class="popover-body-value">'+o+"</span>"}}}},doughnut:{cutoutPercentage:83,tooltips:{callbacks:{title:function(a,e){return e.labels[a[0].index]},label:function(a,e){var t="";return t+='<span class="popover-body-value">'+e.datasets[0].data[a.index]+"</span>"}}},legendCallback:function(a){var o=a.data,n="";return o.labels.forEach(function(a,e){var t=o.datasets[0].backgroundColor[e];n+='<span class="chart-legend-item">',n+='<i class="chart-legend-indicator" style="background-color: '+t+'"></i>',n+=a,n+="</span>"}),n}}}},Chart.scaleService.updateScaleDefaults("linear",{gridLines:{borderDash:[2],borderDashOffset:[2],color:n.gray[300],drawBorder:!1,drawTicks:!1,lineWidth:0,zeroLineWidth:0,zeroLineColor:n.gray[300],zeroLineBorderDash:[2],zeroLineBorderDashOffset:[2]},ticks:{beginAtZero:!0,padding:10,callback:function(a){if(!(a%10))return a}}}),Chart.scaleService.updateScaleDefaults("category",{gridLines:{drawBorder:!1,drawOnChartArea:!1,drawTicks:!1},ticks:{padding:20},maxBarThickness:10}),a)),e.on({change:function(){var a=$(this);a.is("[data-add]")&&l(a)},click:function(){var a=$(this);a.is("[data-update]")&&i(a)}}),{colors:n,fonts:o,mode:t}}(),OrdersChart=function(){var a,e,t=$("#chart-orders");$('[name="ordersSelect"]');t.length&&(a=t,e=new Chart(a,{type:"bar",options:{scales:{yAxes:[{ticks:{callback:function(a){if(!(a%10))return a}}}]},tooltips:{callbacks:{label:function(a,e){var t=e.datasets[a.datasetIndex].label||"",o=a.yLabel,n="";return 1<e.datasets.length&&(n+='<span class="popover-body-label mr-auto">'+t+"</span>"),n+='<span class="popover-body-value">'+o+"</span>"}}}},data:{labels:["Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"Sales",data:[25,20,30,22,17,29]}]}}),a.data("chart",e))}(),SalesChart=function(){var a,e,t=$("#chart-sales");t.length&&(a=t,e=new Chart(a,{type:"line",options:{scales:{yAxes:[{gridLines:{color:Charts.colors.gray[900],zeroLineColor:Charts.colors.gray[900]},ticks:{callback:function(a){if(!(a%10))return"$"+a+"k"}}}]},tooltips:{callbacks:{label:function(a,e){var t=e.datasets[a.datasetIndex].label||"",o=a.yLabel,n="";return 1<e.datasets.length&&(n+='<span class="popover-body-label mr-auto">'+t+"</span>"),n+='<span class="popover-body-value">$'+o+"k</span>"}}}},data:{labels:["May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"Performance",data:[0,20,10,30,15,40,20,60,60]}]}}),a.data("chart",e))}();
var Doctors = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_post = $('#id_doctor').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title: title,
                        title_before: title_before,
                        id: id_post,
                        mod: 'doctor'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);
                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });
            }).change();

        },

        eliminateMessages: function () {
            $('#name').blur(function () {
                if (!$(this).val() == '') {
                    $('#name + p').html('');
                }
            })

            $('#excerpt').blur(function () {
                if (!$(this).val() == '') {
                    $('#excerpt + p').html('');
                }
            })
        },

        createDoctor: function () {
            var $form = $('#doctor-form');
            $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 2,
                        lettersonly: true
                    },
                    lastname: {
                        required: true,
                        minlength: 2,
                        lettersonly: true
                    },
                    phone: {
                        number: true,
                        minlength: 9

                    },
                    rut: {
                        required: true,
                        minlength: 6,
                        maxlength: 9
                    },
                    email: "email",
                    excerpt: "required",
                    imgurl: "required",
                    specialty: "required"
                },
                messages: {
                    name: {
                        required: "El nombre es un campo requerido",
                        minlength: "Escriba un nombre más largo",
                        lettersonly: "Solo se permiten letras"
                    },
                    lastname: {
                        required: "El apellido es un campo requerido",
                        minlength: "Escriba un apellido más largo",
                        lettersonly: "Solo se permiten letras" 
                    },
                    phone: {
                        number: "Ingrese un teléfono válido",
                        minlength: "Ingrese un teléfono válido"
                    },
                    rut: {
                        required: "El rut es un campo requerido",
                        minlength: "No es un rut válido",
                        maxlength: "No es un rut válido",
                    },
                    email: "El email no es válido",
                    excerpt: "El extracto es un campo requerido",
                    imgurl: "No ha agregado una imagen",
                    specialty: "Al menos una especialidad es requerida"
                },
            });

            $('#btn-save').click(function () {
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("doctor-form"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#doctor-form')[0].reset();
                            $(".invalid-feedback").html('');
                            $("#canvas").cropper('destroy');
                            $('#office').val(null).trigger('change');
                            $('#specialty').val(null).trigger('change');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });
            jQuery.validator.addMethod("lettersonly", function (value, element) {
                return this.optional(element) || /^[a-z áãâäàéêëèíîïìóõôöòúûüùçñ]+$/i.test(value);
            }, "Letters and spaces only please");
        },

        editDoctor: function () {
            var $form = $('#doctor-form');
            $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 2,
                        lettersonly: true
                    },
                    lastname: {
                        required: true,
                        minlength: 2,
                        lettersonly: true
                    },
                    phone: {
                        number: true,
                        minlength: 9

                    },
                    rut: {
                        required: true,
                        minlength: 6,
                        maxlength: 9
                    },
                    email: "email",
                    excerpt: "required",
                    imgurl: "required",
                    specialty: "required"
                },
                messages: {
                    name: {
                        required: "El nombre es un campo requerido",
                        minlength: "Escriba un nombre más largo",
                        lettersonly: "Solo se permiten letras"
                    },
                    lastname: {
                        required: "El apellido es un campo requerido",
                        minlength: "Escriba un apellido más largo",
                        lettersonly: "Solo se permiten letras"
                    },
                    phone: {
                        number: "Ingrese un teléfono válido",
                        minlength: "Ingrese un teléfono válido"
                    },
                    rut: {
                        required: "El rut es un campo requerido",
                        minlength: "No es un rut válido",
                        maxlength: "No es un rut válido",
                    },
                    email: "El email no es válido",
                    excerpt: "El extracto es un campo requerido",
                    imgurl: "No ha agregado una imagen",
                    specialty: "Al menos una especialidad es requerida"
                },
            });

            $('#btn-save').click(function () {
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("doctor-form"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });
            jQuery.validator.addMethod("lettersonly", function (value, element) {
                return this.optional(element) || /^[a-z áãâäàéêëèíîïìóõôöòúûüùçñ]+$/i.test(value);
            }, "Letters and spaces only please");
        },

        imageUploadDoctor: function (route) {

            var canvas = $("#canvas"),
                context = canvas.get(0).getContext("2d"),
                $result = $('#result');

            $('#fileInput').on('change', function () {
                if (this.files && this.files[0]) {
                    if (this.files[0].type.match(/^image\//)) {
                        $('#btnCrop').prop('disabled', false);
                        var reader = new FileReader();
                        reader.onload = function (evt) {
                            var img = new Image();
                            img.onload = function () {
                                canvas.cropper('destroy');

                                var MAX_WIDTH = 500;
                                var MAX_HEIGHT = 500;
                                var width = img.width;
                                var height = img.height;

                                context.canvas.height = height;
                                context.canvas.width = width;
                                context.drawImage(img, 0, 0, width, height);
                                var cropper = canvas.cropper({
                                    aspectRatio: 1 / 1,
                                    background: true,
                                    autoCropArea: 1,
                                    viewMode: 1,
                                    width: 500,
                                    height: 500
                                });
                            };
                            img.src = evt.target.result;
                        };
                        reader.readAsDataURL(this.files[0]);
                    }
                    else {
                        alert("Invalid file type! Please select an image file.");
                    }
                }
                else {
                    alert('No file(s) selected.');
                }
            });

            $('#btnCrop').click(function (evento) {
                evento.preventDefault();
                $('.imagen-add').html('');
                $(this).button('loading');
                var croppedImageDataURL = canvas.cropper('getCroppedCanvas').toDataURL("image/png");
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        img: croppedImageDataURL,
                    },
                }).done(function (data) {
                    var imgurl = data.data.img_url;
                    $('#imgurl').val(data.data.img_name);
                    $("#avatar-doctor").attr("src", imgurl);
                    $('#modal-notification').modal('hide');
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btnCrop').button('reset');
                });

            });

        },

        allDoctors: function () {
            var route = $('.datatable-doctors').data('route');
            var table = $('.datatable-doctors').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[4, "desc"]],
                columns: [
                    {
                        data: 'file',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a class="avatar avatar-sm"><img src="' + data + '" class="rounded-circle "></a>';
                            return concat;
                        }
                    },
                    {
                        data: 'name',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },
                    {
                        data: 'phone',
                        width: "100px"
                    },
                    {
                        data: 'email',
                        width: "100px"
                    },
                    {
                        data: 'status',
                        width: "80px",
                        render: function (data, type, row, meta) {
                            var button;
                            if (data == "INACTIVE") {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" data-on="Activo" data-off="Inactivo" data-onstyle="info" data-size="small">';
                            } else {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" checked data-on="Activo" data-off="Inactivo"  data-onstyle="info" data-size="small">';
                            }
                            return button;
                        }
                    },
                    {
                        data: 'route',
                        width: "120px",
                        visible: false
                    },
                    {
                        data: 'id',
                        width: "120px",
                        visible: false
                    }

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] },
                    { className: "cdatatable-td", targets: [4] }
                ],
                fnInitComplete: function () {
                    $('.toggle-check').bootstrapToggle();
                    $(".datatable-doctors").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

        changeStatus: function () {
            $(document).on('click', '.toggle', function () {
                var $input = $(this).find('input.toggle-check');
                var status = ($input.is(':checked')) ? 'ACTIVE' : 'INACTIVE';
                $.ajax({
                    type: 'post',
                    url: $('.datatable-doctors').data('route-status'),
                    data: {
                        id: $input.data('id'),
                        status: status
                    }
                }).done(function (data) {
                   
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                   
                });
            });
        },
    }
}();
var Posts = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_post = $('#id_post').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title: title,
                        title_before: title_before,
                        id: id_post,
                        mod: 'post'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);
                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });

            }).change();
        },

        editHTML: function () {
            $('#body').summernote({
                height: 200

            });
        },

        eliminateMessages: function () {
            $('#name').blur(function () {
                if (!$(this).val() == '') {
                    $('#name + p').html('');
                }
            })

            $('#excerpt').blur(function () {
                if (!$(this).val() == '') {
                    $('#excerpt + p').html('');
                }
            })

        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });
        },

        tagsInput: function () {
            $('input[name="tags"]').amsifySuggestags({
                type: 'amsify'
            });
        },

        createPost: function () {
            var $form = $('#post');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    excerpt: "required",
                    body: "required",
                    image: "required"
                },
                messages: {
                    name: {
                        required: "El titulo es un campo requerido",
                        minlength: "Escriba un titulo más largo"
                    },
                    excerpt: "El extracto es un campo requerido",
                    body: "No ha agregado contenido",
                    image: "No ha agregado una imagen"
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("post"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#post')[0].reset();
                            $("#body").summernote("reset");
                            $("#image-preview").css('background-image', '');
                            $(".invalid-feedback").html('');
                            $(".amsify-suggestags-input-area").remove('.amsify-select-tag');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        editPost: function () {
            var $form = $('#post');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    excerpt: "required",
                    body: "required"
                },
                messages: {
                    name: {
                        required: "El titulo es un campo requerido",
                        minlength: "Escriba un titulo más largo"
                    },
                    excerpt: "El extracto es un campo requerido",
                    body: "No ha agregado contenido"
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("post"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        allPosts: function () {
            var route = $('.datatable-posts').data('route');
            var table = $('.datatable-posts').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[4, "desc"]],
                columns: [
                    {
                        data: 'title',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },
                    {
                        data: 'category',
                        width: "100px"
                    },
                    {
                        data: 'tags',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = "";
                            jQuery.each(data, function (i, val) {
                                concat += '<span class="badge badge-info">' + val + '</span>'
                            });
                            return concat;
                        }
                    },
                    {
                        data: 'created',
                        width: "120px"
                    },
                    {
                        data: 'status',
                        width: "80px",
                        render: function (data, type, row, meta) {
                            var button;
                            if (data == "DRAFT") {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" data-on="Publicado" data-off="Borrador" data-onstyle="info" data-size="small">';
                            } else {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" checked data-on="Publicado" data-off="Borrador"  data-onstyle="info" data-size="small">';
                            }
                            return button;
                        }
                    },
                    {
                        data: 'route',
                        width: "120px",
                        visible: false
                    },
                    {
                        data: 'id',
                        width: "120px",
                        visible: false
                    }

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] },
                    { className: "cdatatable-td", targets: [4] }
                ],
                fnInitComplete: function () {
                    $('.toggle-check').bootstrapToggle();
                    $(".datatable-posts").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

        changeStatus: function () {
            $(document).on('click', '.toggle', function () {
                var $input = $(this).find('input.toggle-check');
                var status = ($input.is(':checked')) ? 'PUBLISHED' : 'DRAFT';
                $.ajax({
                    type: 'post',
                    url: $('.datatable-posts').data('route-status'),
                    data: {
                        id: $input.data('id'),
                        status: status
                    }
                }).done(function (data) {
                   
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                   
                });
            });
        },

        datePicker: function () {
            var $dateRange = $('#date-range');
            $dateRange.daterangepicker({
                autoApply: true,
                opens: 'left',
                startDate: moment(),
                endtDate: moment(),
                showDropdowns: true,
                showWeekNumbers: true,
                buttonClasses: ['btn btn-sm'],
                applyClass: ' blue',
                cancelClass: 'default',
                format: 'DD/MM/YYYY',
                separator: ' to ',
                locale: {
                    applyLabel: 'Aceptar',
                    cancelLabel: 'Cancelar',
                    fromLabel: 'Desde',
                    toLabel: 'Hasta',
                    customRangeLabel: 'Rango Personalizado',
                    daysOfWeek: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
                    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                    firstDay: 1
                }
            },
                function (start, end) {
                    $('#date-range span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                }
            );

            $('#date-range span').html(moment().format('MMMM D, YYYY') + ' - ' + moment().format('MMMM D, YYYY'));
            $('#start_date').val(moment().format('YYYY-MM-DD'));
            $('#end_date').val(moment().format('YYYY-MM-DD'));

            $dateRange.on('apply.daterangepicker', function (ev, picker) {
                $('#start_date').val(picker.startDate.format('YYYY-MM-DD'));
                $('#end_date').val(picker.endDate.format('YYYY-MM-DD'));
            });
        }

    }
}();
var Offices = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_post = $('#id_office').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title: title,
                        title_before: title_before,
                        id: id_post,
                        mod: 'office'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);
                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });

            }).change();
        },

        editHTML: function () {
            $('#body').summernote({
                height: 200

            });
        },

        eliminateMessages: function () {
            $('#name').blur(function () {
                if (!$(this).val() == '') {
                    $('#name + p').html('');
                }
            })

            $('#excerpt').blur(function () {
                if (!$(this).val() == '') {
                    $('#excerpt + p').html('');
                }
            })

        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });
        },

        createOffice: function () {
            var $form = $('#office');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    phone: {
                        number: true,
                        minlength: 9,
                        required: true
                    },
                    map: "required",
                    address: "required",
                    image: "required"
                },
                messages: {
                    name: {
                        required: "El titulo es un campo requerido",
                        minlength: "Escriba un titulo más largo"
                    },
                    phone: { 
                        number: 'Solo se permiten numeros',
                        minlength: "Escriba un número válido",
                        required: "El número es requerido"
                    },
                    map: "El map es un campo requerido",
                    address: "No ha agregado la dirección",
                    image: "No ha agregado una imagen"
                }
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("office"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#office')[0].reset();
                            $("#image-preview").css('background-image', '');
                            $(".invalid-feedback").html('');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });
        },

        editOffice: function () {
            var $form = $('#office');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    phone: {
                        number: true,
                        minlength: 9,
                        required: true
                    },
                    map: "required",
                    address: "required"
                },
                messages: {
                    name: {
                        required: "El titulo es un campo requerido",
                        minlength: "Escriba un titulo más largo"
                    },
                    phone: { 
                        number: 'Solo se permiten numeros',
                        minlength: "Escriba un número válido",
                        required: "El número es requerido"
                    },
                    map: "El map es un campo requerido",
                    address: "No ha agregado la dirección"
                }
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("office"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });
        },

        selectOffice: function (datajson) {
            var $officeSearch = $('#office');

            $officeSearch.select2({
                multiple: true,
                tags: false,
                placeholder: "...",
                maximumSelectionSize: 6,
                minimumInputLength: 1,
                tokenSeparators: [",", " "],
                createTag: function (item) {
                    return {
                        id: item.term,
                        text: item.term,
                    };
                },
                templateResult: function (item) {
                    return item.name;
                },
                templateSelection: function (item) {
                    return item.name;
                },
                escapeMarkup: function (markup) { return markup; },
                ajax: {
                    url: $officeSearch.data('route'),
                    dataType: "json",
                    global: false,
                    cache: true,
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term
                        };
                    },
                    processResults: function (data) {

                        return {
                            results: data.data.tags,
                        };
                    }
                }
            });

        },

        selectOfficeEdit: function () {
            $("#office").select2({
                tags: false,
                multiple: true,
                tokenSeparators: [',', ' ']
            })
        },

        allOffices: function () {
            var route = $('.datatable-offices').data('route');
            var table = $('.datatable-offices').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[1, "asc"]],
                columns: [
                    {
                        data: 'name',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },
                    {
                        data: 'phone',
                        width: "100px"
                    },
                    {
                        data: 'address',
                        width: "100px"
                    },
                   
                    {
                        data: 'route',
                        visible: false
                    },
                    {
                        data: 'id',
                        visible: false
                    }

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] }
                ],
                fnInitComplete: function () {

                    $(".datatable-offices").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

    
    }
}();
var Surgery = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_surgery = $('#id_surgery').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title_before: title_before,
                        title: title,
                        id: id_surgery,
                        mod: 'surgery'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);

                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });
            }).change();
        },

        editHTML: function () {
            $('#indications').summernote({
                height: 200
            });
            $('#preparation').summernote({
                height: 200
            });
            $('#description').summernote({
                height: 200
            });
        },


        editSurgery: function () {
            var $form = $('#surgery');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    description: "required"
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    description: "No ha agregado contenido",
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("surgery"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        createSurgery: function () {
            var $form = $('#surgery');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    description: "required",
                    image: "required"
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    description: "No ha agregado contenido",
                    image: "No ha agregado una imagen"
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("surgery"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#surgery')[0].reset();
                            $("#description").summernote("reset");
                            $("#preparation").summernote("reset");
                            $("#indications").summernote("reset");
                            $("#image-preview").css('background-image', '');
                            $(".invalid-feedback").html('');
                            $('#office').val(null).trigger('change');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });
        },


        allSurgeries: function () {
            var route = $('.datatable-surgeries').data('route');
            var table = $('.datatable-surgeries').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[4, "desc"]],
                columns: [
                    {
                        data: 'name',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },

                    {
                        data: 'created',
                        width: "120px"
                    },
                    {
                        data: 'status',
                        width: "80px",
                        render: function (data, type, row, meta) {
                            var button;
                            if (data == "DRAFT") {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" data-on="Publicado" data-off="Borrador" data-onstyle="info" data-size="small">';
                            } else {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" checked data-on="Publicado" data-off="Borrador"  data-onstyle="info" data-size="small">';
                            }
                            return button;
                        }
                    },
                    {
                        data: 'route',
                        visible: false
                    },
                    {
                        data: 'id',
                        visible: false
                    },

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] },
                ],
                fnInitComplete: function () {
                    $('.toggle-check').bootstrapToggle();
                    $(".datatable-surgeries").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

        changeStatus: function () {
            $(document).on('click', '.toggle', function () {
                var $input = $(this).find('input.toggle-check');
                var status = ($input.is(':checked')) ? 'PUBLISHED' : 'DRAFT';
                $.ajax({
                    type: 'post',
                    url: $('.datatable-surgeries').data('route-status'),
                    data: {
                        id: $input.data('id'),
                        status: status
                    }
                }).done(function (data) {
                   
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                   
                });
            });
        },

    }
}();
var Exams = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_exam = $('#id_exam').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title_before: title_before,
                        title: title,
                        id: id_exam,
                        mod: 'exam'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);

                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });
            }).change();
        },

        createExam: function () {
            var $form = $('#exam');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    description: "required",
                    image: "required"
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    description: "No ha agregado contenido",
                    image: "No ha agregado una imagen"
                },
                ignore: ":hidden, [contenteditable='true']:not([description])"
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("exam"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#exam')[0].reset();
                            $("#preparation").summernote("reset");
                            $("#indications").summernote("reset");
                            $("#description").summernote("reset");
                            $("#image-preview").css('background-image', '');
                            $(".invalid-feedback").html('');
                            $('#office').val(null).trigger('change');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#description').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        editExam: function () {
            var $form = $('#exam');
            var v = $('#exam').validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    description: "required",
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    description: "No ha agregado contenido",
                },
                ignore: ":hidden, [contenteditable='true']:not([description])"
            });

            $('#btn-save').click(function (e) {
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("exam"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#description').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        editHTML: function () {
            $('#preparation').summernote({
                height: 200
            });
            $('#description').summernote({
                height: 200
            });
            $('#indications').summernote({
                height: 200
            });
        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });

        },


        allExams: function () {
            var route = $('.datatable-exams').data('route');
            var table = $('.datatable-exams').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[1, "asc"]],
                columns: [
                    {
                        data: 'name',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },
                    {
                        data: 'created',
                        width: "120px"
                    },
                    {
                        data: 'status',
                        width: "80px",
                        render: function (data, type, row, meta) {
                            var button;
                            if (data == "DRAFT") {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" data-on="Publicado" data-off="Borrador" data-onstyle="info" data-size="small">';
                            } else {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" checked data-on="Publicado" data-off="Borrador"  data-onstyle="info" data-size="small">';
                            }
                            return button;
                        }
                    },
                    {
                        data: 'route',
                        visible: false
                    },
                    {
                        data: 'id',
                        visible: false
                    }

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] },
                ],
                fnInitComplete: function () {
                    $('.toggle-check').bootstrapToggle();
                    $(".datatable-exams").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

        changeStatus: function () {
            $(document).on('click', '.toggle', function () {
                var $input = $(this).find('input.toggle-check');
                var status = ($input.is(':checked')) ? 'PUBLISHED' : 'DRAFT';
                $.ajax({
                    type: 'post',
                    url: $('.datatable-exams').data('route-status'),
                    data: {
                        id: $input.data('id'),
                        status: status
                    }
                }).done(function (data) {
                   
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                   
                });
            });
        },

    }
}();
var Specialty = function () {

    return {

        slug: function () {
            var route = $('#slug').data('route');
            var title_before = $('#name').val();
            $('#name').change(function () {
                var title = $('#name').val();
                var id_specialty = $('#id_specialty').val();
                $("#btn-save").button('loading');
                $.ajax({
                    type: 'post',
                    url: route,
                    dataType: "json",
                    data: {
                        title_before: title_before,
                        title: title,
                        id: id_specialty,
                        mod: 'specialty'
                    },
                }).done(function (data) {
                    $('#slug').val(data.data.slug);
                    var html = $('#slug-url').data('slug');
                    var url = html + "/" + data.data.slug;
                    $('#slug-url').html(url);
                    $('#slug-url').attr('href', url);

                }).fail(function (data) {

                }).always(function () {
                    $('#btn-save').button('reset');
                });
            }).change();
        },

        editHTML: function () {
            $('#body').summernote({
                height: 200
            });
        },


        editSpecialty: function () {
            var $form = $('#specialty');
            var v = $('#specialty').validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    body: "required"
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    body: "No ha agregado contenido",
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("specialty"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        createSpecialty: function () {
            var $form = $('#specialty');
            var v = $form.validate({
                rules: {
                    name: {
                        required: true,
                        minlength: 5
                    },
                    body: "required",
                    image: "required"
                },
                messages: {
                    name: {
                        required: "El título es un campo requerido",
                        minlength: "Escriba un título más largo"
                    },
                    body: "No ha agregado contenido",
                    image: "No ha agregado una imagen"
                },
                ignore: ":hidden, [contenteditable='true']:not([body])"
            });

            $('#btn-save').click(function (e) {
                e.preventDefault();
                if ($form.valid()) {
                    $(this).button('loading');
                    var formData = new FormData(document.getElementById("specialty"));
                    $.ajax({
                        type: 'post',
                        url: $form.attr('action'),
                        data: formData,
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    }).done(function (data) {
                        if (data.status == 400) {
                            $.each(data.data, function (key, value) {
                                $('.' + key + '-error').html(value);
                            });
                        }
                        if (data.status == 200) {
                            toastr.success(data.message, '!Exitoso!');
                            $('#specialty')[0].reset();
                            $("#body").summernote("reset");
                            $("#image-preview").css('background-image', '');
                            $(".invalid-feedback").html('');
                            var html = $('#slug-url').data('slug');
                            $('#slug-url').html(html);
                        }
                    }).fail(function (data) {
                        toastr.error(data.message, '!Error!');
                    }).always(function () {
                        $('#btn-save').button('reset');
                    });
                    return false;
                }
            });

            $('#body').summernote({
                callbacks: {
                    onChange: function (contents, $editable) {
                        myElement.val(myElement.summernote('isEmpty') ? "" : contents);
                        v.element(myElement);
                    }
                }
            });
        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });
        },


        allSurgeries: function () {
            var route = $('.datatable-specialties').data('route');
            var table = $('.datatable-specialties').DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": route,
                "responsive": true,
                "order": [[4, "desc"]],
                columns: [
                    {
                        data: 'name',
                        width: "100px",
                        render: function (data, type, row, meta) {
                            var concat = '<a href="' + row.route + '">' + data + '</a>';
                            return concat;
                        }
                    },

                    {
                        data: 'created',
                        width: "120px"
                    },
                    {
                        data: 'status',
                        width: "80px",
                        render: function (data, type, row, meta) {
                            var button;
                            if (data == "DRAFT") {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" data-on="Publicado" data-off="Borrador" data-onstyle="info" data-size="small">';
                            } else {
                                button = '<input type="checkbox" class="toggle-check" data-id="' + row.id + '" data-toggle="toggle" checked data-on="Publicado" data-off="Borrador"  data-onstyle="info" data-size="small">';
                            }
                            return button;
                        }
                    },
                    {
                        data: 'route',
                        visible: false
                    },
                    {
                        data: 'id',
                        visible: false
                    },

                ],
                columnDefs: [
                    { className: "cdatatable-td", targets: [0] },
                    { className: "cdatatable-td", targets: [1] },
                    { className: "cdatatable-td", targets: [2] },
                    { className: "cdatatable-td", targets: [3] },
                ],
                fnInitComplete: function () {
                    $('.toggle-check').bootstrapToggle();
                    $(".datatable-specialties").css("width", "100%");
                },
                fnDrawCallback: function() {
                    $('.toggle-check').bootstrapToggle();
                },
                "lengthMenu": [[10, 25, 50, 100, 200, 300, 400, 500], [10, 25, 50, 100, 200, 300, 400, 500]]
            });
            table.columns.adjust().draw();
        },

        changeStatus: function () {
            $(document).on('click', '.toggle', function () {
                var $input = $(this).find('input.toggle-check');
                var status = ($input.is(':checked')) ? 'PUBLISHED' : 'DRAFT';
                $.ajax({
                    type: 'post',
                    url: $('.datatable-specialties').data('route-status'),
                    data: {
                        id: $input.data('id'),
                        status: status
                    }
                }).done(function (data) {
                   
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                   
                });
            });
        },

    }
}();
var Agreement = function () {

    function tableTrFon(title, description, key) {
        var tr = '<tr>';
        tr += '<td width="20%">';
        tr += title;
        tr += '</td>';
        tr += ' <td width="75%">';
        tr += description;
        tr += '</td>';
        tr += ' <td width="5%">';
        tr += '<button class="btn btn-primary btn-sm min-tr-fon" data-key="' + key + '"><i class="ni ni-fat-delete" style="font-size: 18px"></i> </button>'
        tr += '</td>';
        tr += '</tr>';

        return tr;

    }


    function tableTr(img, ges, cuenta, cuenta_title, ky) {
        var tr = '<tr>'
        tr += '<td width="35%">'
        tr += '<img src="' + img + '" width="100%">'
        tr += ' </td>'
        tr += '<td width="30%">'
        tr += '<ul class="is-ges">'
        tr += ges
        tr += '</ul>'
        tr += ' </td>'
        tr += '<td width="30%">'
        tr += cuenta_title
        tr += ' <ul class="is-cu">'
        tr += cuenta
        tr += ' </ul>'
        tr += '</td>'
        tr += '<td width="5%">'
        tr += '<button class="btn btn-primary min-tr btn-sm" data-key="' + ky + '"><i class="ni ni-fat-delete" style="font-size: 18px"></i> </button>'
        tr += '</td>'
        tr += '</tr>'
        return tr;
    }

    function imgSort(img) {
        var div = '<li data-img="' + img + '">';
        div += '<div class="box-image nostatus">';
        div += '<button type="button" class="btn btn-success btn-sm pull-right conv-delete">x</button>'
        div += '<img src="' + img + '" width="100%">';
        div += '</div>';
        div += '</li>';
        return div;
    }

    return {



        minTrFonasa: function () {
            var wrapper = $('.table-fonasa > tbody');
            $(wrapper).on('click', '.min-tr-fon', function (e) {
                e.preventDefault();
                var tr = $(this).parents('tr').index() - 1;
                var slug = $('#fonasa-slug').val();
                $(this).parents('tr').remove();
                $.ajax({
                    type: 'post',
                    url: $('#fonasa_add').data('route'),
                    data: {
                        index: $(this).data('key'),
                        slug: slug
                    },
                    dataType: "json"
                }).done(function (data) {
                    if (data.status == 200) {
                        toastr.success(data.message, '!Exitoso!');
                    }
                    if (data.status == 400) {
                        toastr.error(data.message, '!Error!');
                    }
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btn-addfonasa').button('reset');
                });
                return false;
            });

        },

        minTr: function () {
            var wrapper = $('.table-isapres > tbody');
            $(wrapper).on('click', '.min-tr', function (e) {
                e.preventDefault();
                var tr = $(this).parents('tr').index() - 1;
                var slug = $('#isapre_slug').val();
                $(this).parents('tr').remove();
                $.ajax({
                    type: 'post',
                    url: $('#isapre_add').data('route'),
                    data: {
                        index: $(this).data('key'),
                        slug: slug
                    },
                    dataType: "json"
                }).done(function (data) {
                    if (data.status == 200) {
                        toastr.success(data.message, '!Exitoso!');
                    }
                    if (data.status == 400) {
                        toastr.error(data.message, '!Error!');
                    }
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btn-addisapre').button('reset');
                });
                return false;
            });

        },


        addGes: function () {
            var input = '<li><div class="input-group input-group-sm mb-3">' +
                '<input type="text" class="form-control input-sm" name="isapreges[]" placeholder="" aria-label="" aria-describedby="basic-addon2">' +
                '<div class="input-group-append">' +
                '<button class="btn btn-primary min-ges-inp" type="button"><i class="ni ni-fat-delete " style=""></i></button>' +
                '</div>' +
                '</div></li>';
            var maxField = 100;
            var addButton = $('.add-ges-inp');
            var wrapper = $(".is-ges");
            var x = 1;

            $(addButton).click(function () {
                if (x < maxField) {
                    x++;
                    $(wrapper).append(input);
                }
            });

            $(wrapper).on('click', '.min-ges-inp', function (e) {
                e.preventDefault();
                $(this).parents('li').remove();
                x--;
            });
        },

        addCu: function () {
            var input = '<li><div class="input-group input-group-sm mb-3">' +
                '<input type="text" class="form-control input-sm" name="isaprecuenta[]" placeholder="" aria-label="" aria-describedby="basic-addon2">' +
                '<div class="input-group-append">' +
                '<button class="btn btn-primary min-cu-inp" type="button"><i class="ni ni-fat-delete" style=""></i></button>' +
                '</div>' +
                '</div></li>';

            var maxField = 100;
            var addButton = $('.add-cu-inp');
            var wrapper = $(".is-cu");
            var x = 1;

            $(addButton).click(function () {
                if (x < maxField) {
                    x++;
                    $(wrapper).append(input);
                }
            });

            $(wrapper).on('click', '.min-cu-inp', function (e) {
                e.preventDefault();
                $(this).parents('li').remove();
                x--;
            });
        },

        imagesUpCon: function (image) {
            $.uploadPreview({
                input_field: "#convenio-image",
                preview_box: "#convenio-image-preview",
                label_field: "#convenio-image-label",
                label_default: image,
                label_selected: image
            });
        },

        imagesUp: function (image) {
            $.uploadPreview({
                input_field: "#isapre-image",
                preview_box: "#isapre-image-preview",
                label_field: "#isapre-image-label",
                label_default: image,
                label_selected: image
            });
        },

        imagesUpProm: function (image) {
            $.uploadPreview({
                input_field: "#promo-image",
                preview_box: "#promo-image-preview",
                label_field: "#promo-image-label",
                label_default: image,
                label_selected: image
            });
        },

        isapreAdd: function () {
            var $form = $('#isapre_add');
            $('#btn-addisapre').click(function (e) {
                $(this).button('loading');
                var formData = new FormData(document.getElementById("isapre_add"));
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: formData,
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function (data) {
                    var ky = '';
                    var cuenta = '';
                    var cuenta_title = '';
                    var ges = '';
                    var image = '';
                    if (data.status == 400) {
                        toastr.error(data.message, '!Error!');
                    }
                    if (data.status == 200) {
                        var json = JSON.parse(data.data);
                        $.each(json, function (k, val) {
                            ky = k;
                            image = val.image;
                            $.each(val, function (key, value) {
                                if (key == 'ges') {
                                    $.each(value, function (keyg, valueg) {
                                        ges += '<li>' + valueg.name + '</li>';
                                    });
                                }
                                if (key == 'account') {
                                    cuenta_title = value.title;
                                    $.each(value.content, function (keyc, valuec) {
                                        cuenta += '<li>' + valuec.name + '</li>';
                                    });
                                }
                            });
                        });
                        var tr = tableTr(image, ges, cuenta, cuenta_title, ky);
                        $('.table-isapres tbody').append(tr);
                        toastr.success(data.message, '!Exitoso!');
                    }
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btn-addisapre').button('reset');
                });
                return false;
            });

        },

        convenioAdd: function () {
            var $form = $('#convenio_add');
            $('#btn-addconvenio').click(function () {
                $(this).button('loading');
                var formData = new FormData(document.getElementById("convenio_add"));
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: formData,
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function (data) {

                    if (data.status === 400) {
                        toastr.error(data.message, '!Error!');
                    }
                    if (data.status === 200) {

                        var img = data.data;

                        var div = imgSort(img);
                        $('#sortable').append(div);
                        toastr.success(data.message, '!Exitoso!');
                    }
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btn-addconvenio').button('reset');
                });
                return false;
            });

            $('#sortable').on('click', '.conv-delete', function (e) {
                e.preventDefault();
                $(this).parents('li').remove();
            })
        },

        fonasaAdd: function () {
            var $form = $('#fonasa_add');
            $('#btn-addfonasa').click(function () {
                $(this).button('loading');
                var formData = new FormData(document.getElementById("fonasa_add"));
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: formData,
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function (data) {
                    var title = '';
                    var description = '';
                    var key = '';
                    if (data.status === 400) {
                        toastr.error(data.message, '!Error!');
                    }
                    if (data.status === 200) {
                        var json = JSON.parse(data.data);
                        $.each(json, function (k, val) {
                            key = k;
                            title = val.subtitle;
                            description = val.subdescription;
                        });

                        var tr = tableTrFon(title, description, key);
                        $('.table-fonasa tbody').append(tr);
                        toastr.success(data.message, '!Exitoso!');
                    }
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#btn-addfonasa').button('reset');
                });
                return false;
            });
        },

        saveIsapre: function () {
            var $form = $('#isapre');
            $('#isapre-btn-save').click(function (e) {
                $(this).button('loading');
                var formData = new FormData(document.getElementById("isapre"));
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: formData,
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function (data) {
                    toastr.success(data.message, '!Exitoso!');
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#isapre-btn-save').button('reset');
                });
                return false;
            });
        },

        saveFonasa: function () {
            var $form = $('#fonasa');
            $('#fonasa-btn-save').click(function (e) {
                $(this).button('loading');
                var formData = new FormData(document.getElementById("fonasa"));
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: formData,
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false
                }).done(function (data) {
                    toastr.success(data.message, '!Exitoso!');
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#fonasa-btn-save').button('reset');
                });
                return false;
            });
        },

        saveConvenio: function () {
            var $form = $('#convenio');
            $('#convenio-btn-save').click(function (e) {
                $(this).button('loading');
                var title = $('#convenio-title').val();
                var slug = $('#convenio-slug').val();
                var description = $('textarea#convenio-description').val();
                var mylist = [];
                var i = 1;
                $("ul#sortable > li").each(function () {
                    mylist.push({
                        "id": i,
                        "img": $(this).data('img')
                    });
                    i++
                })

                console.log(mylist);
                $.ajax({
                    type: 'post',
                    url: $form.attr('action'),
                    data: {
                        slug: slug,
                        title: title,
                        description: description,
                        list: mylist
                    },
                    dataType: "json"

                }).done(function (data) {
                    toastr.success(data.message, '!Exitoso!');
                }).fail(function (data) {
                    toastr.error(data.message, '!Error!');
                }).always(function () {
                    $('#convenio-btn-save').button('reset');
                });
                return false;
            });


        },

        showAgreements: function () {
            $.ajax({
                type: 'post',
                url: $('.agreements-content').data('route'),
                dataType: "json"
            }).done(function (data) {
                var ky = '';
                var cuenta = '';
                var cuenta_title = '';
                var ges = '';
                var image = '';
                if (data.status == 400) {
                    toastr.error(data.message, '!Error!');
                }
                if (data.status == 200) {
                    var json = JSON.parse(data.data);
                    $.each(json, function (k, val) {
                        ky = k;
                        image = val.image;
                        $.each(val, function (key, value) {
                            if (key == 'ges') {
                                $.each(value, function (keyg, valueg) {
                                    ges += '<li>' + valueg.name + '</li>';
                                });
                            }
                            if (key == 'account') {
                                cuenta_title = value.title;
                                $.each(value.content, function (keyc, valuec) {
                                    cuenta += '<li>' + valuec.name + '</li>';
                                });
                            }
                        });
                    });
                    var tr = tableTr(image, ges, cuenta, cuenta_title, ky);
                    $('.table-isapres tbody').append(tr);
                    toastr.success(data.message, '!Exitoso!');
                }
                toastr.success(data.message, '!Exitoso!');
            }).fail(function (data) {
                toastr.error(data.message, '!Error!');
            });
            return false;
        },

        imageUpload: function (image) {
            $.uploadPreview({
                input_field: "#fonasa-image",
                preview_box: "#image-preview",
                label_field: "#image-label",
                label_default: image,
                label_selected: image
            });
        },

        pagoDropzone: function () {
            Dropzone.options.myAwesomeDropzone = {
                paramName: "image",
                maxFilesize: 30,
                url: 'UploadImages',
                previewsContainer: "#dropzone-previews",
                uploadMultiple: true,
                parallelUploads: 5,
                maxFiles: 30,
                addRemoveLinks: true,
                init: function () {
                    var cd;
                    this.on("success", function (file, response) {
                        $('.dz-progress').hide();
                        $('.dz-size').hide();
                        $('.dz-error-mark').hide();
                        console.log(response);
                        console.log(file);
                        cd = response;
                    });
                    this.on("addedfile", function (file) {
                        var unique_field_id = new Date().getTime();
                    
                        title = file.title == undefined ? "" : file.title;
                        file._titleLabel = Dropzone.createElement("<p>Title:</p>")
                        file._titleBox = Dropzone.createElement("<input id='"+file.name+unique_field_id+"_title' type='text' name='title' value="+title+" >");
                        file.previewElement.appendChild(file._titleLabel);
                        file.previewElement.appendChild(file._titleBox);
                    
                        description = file.description == undefined ? "" : file.description;
                        file._descriptionLabel = Dropzone.createElement("<p>Description:</p>")
                        file._descriptionBox = Dropzone.createElement("<input id='"+file.name+unique_field_id+"_desc' type='text' name='description' value="+description+" >");
                        file.previewElement.appendChild(file._descriptionLabel);
                        file.previewElement.appendChild(file._descriptionBox);
                    });
                    this.on("removedfile", function (file) {

                        var rmvFile = "";
                        for (var f = 0; f < fileList.length; f++) {
                            if (fileList[f].fileName == file.name) {
                                rmvFile = fileList[f].serverFileName;
                            }
                        }

                        if (rmvFile) {
                            $.ajax({
                                url: path, 
                                type: "POST",
                                data: {
                                    filenamenew: rmvFile,
                                    type: 'delete',
                                },
                            });
                        }
                        /*  var removeButton = Dropzone.createElement("<a href='#'>Remove file</a>");
                          var _this = this;
  
                          if (currentFile) {
                              this.removeFile(currentFile);
                          }
                          currentFile = file;
                          removeButton.addEventListener("click", function (e) {
                              e.preventDefault();
                              e.stopPropagation();
                              _this.removeFile(file);
                              var name = "largeFileName=" + cd.pi.largePicPath + "&smallFileName=" + cd.pi.smallPicPath;
                              $.ajax({
                                  type: 'POST',
                                  url: 'DeleteImage',
                                  data: name,
                                  dataType: 'json'
                              });
                          });
                          file.previewElement.appendChild(removeButton);*/
                    });
                }
            };
        },

        editHTMLFonasa: function () {
            $('#fonasa-description').summernote({
                height: 150
            });
        },

        editHTMLIsapre: function () {
            $('#isapre-description').summernote({
                height: 150
            });
        },

        editHTMLConvenio: function () {
            $('#convenio-description').summernote({
                height: 150
            });
        },

        editHTMLProm: function () {
            $('#promo-description').summernote({
                height: 150
            });
        }

    }
}();

var Core = function () {

    return {

        dropdown: function () {
            $('.user-log > .nav-item ').click(function () {
                if ($('.dropdown-menu').hasClass('show')) {
                    $('.dropdown-menu').removeClass('show');
                    $('.nav-item .dropdown').removeClass('show');
                } else {
                    $('.dropdown-menu').addClass('show');
                    $('.nav-item .dropdown').addClass('show');
                }
            });
        },

        sortableImg: function () {
            $("#sortable").sortable();
            $("#sortable").disableSelection();
        }

    }
}();